<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body { font-family: Arial, sans-serif; color: #333; }
    h2 { color: #2c3e50; }
    .property { margin-top: 20px; }
    .task { margin-left: 15px; }
    .footer { margin-top: 30px; font-size: 13px; color: #999; }
  </style>
</head>
<body>
    <h2>Hi {{ name }},</h2>
    <p>Hereâ€™s a quick summary of your tasks updated in the last 24 hours:</p>

    {% for property, status_dict in grouped_tasks %}
      <h3>ğŸ  {{ property }}</h3>
      {% for status, tasks in status_dict.items %}
        <strong>{% if status == "in-progress" %}ğŸš§ In Progress{% elif status == "completed" %}âœ… Completed{% else %}{{ status|title }}{% endif %}:</strong>
        <ul>
          {% for task in tasks %}
            <li style="color: {{ task.status_color }}">
              {{ task.title }}
              {% if task.due_date %}
                {% if task.due_date < now %}
                  â€“ <span style="color: red;">OVERDUE (due {{ task.due_date|date:"M d, Y H:i" }})</span>
                {% else %}
                  â€“ due {{ task.due_date|date:"M d, Y H:i" }}
                {% endif %}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% endfor %}
    {% endfor %}

    <p>Best,<br>Aristay Task Management Team</p>
</body>
<span style="display:none; font-size:0; line-height:0;">
  {{ name }}, updated tasks across properties like
  {% for property, _ in grouped_tasks %}{{ property }}{% if not forloop.last %}, {% endif %}{% endfor %}
</span>
</html>