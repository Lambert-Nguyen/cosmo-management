{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
&rsaquo; <a href="{% url 'admin:'|add:opts.app_label|add:'_'|add:opts.model_name|add:'_changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
&rsaquo; <a href="{% url 'admin:'|add:opts.app_label|add:'_'|add:opts.model_name|add:'_change' object.pk %}">{{ object|truncatewords:"18" }}</a>
&rsaquo; {% trans 'History' %}
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <div class="module">
        <h2>{% trans 'History' %}</h2>
        
        {% if history %}
            <div class="results">
                <table id="result_list">
                    <thead>
                        <tr>
                            <th scope="col">{% trans 'Date/time' %}</th>
                            <th scope="col">{% trans 'User' %}</th>
                            <th scope="col">{% trans 'Action' %}</th>
                            <th scope="col">{% trans 'Changes' %}</th>
                            <th scope="col">{% trans 'Source' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in history %}
                        <tr class="{% cycle 'row1' 'row2' %}">
                            <td>{{ entry.timestamp|date:"DATETIME_FORMAT" }}</td>
                            <td>{{ entry.user }}</td>
                            <td>
                                {% if entry.type == 'admin' %}
                                    <span class="badge badge-info">{{ entry.action }}</span>
                                {% else %}
                                    <span class="badge badge-success">{{ entry.action }}</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if entry.type == 'admin' %}
                                    <div class="admin-changes">{{ entry.changes|linebreaks }}</div>
                                {% else %}
                                    <div class="dashboard-changes">{{ entry.changes }}</div>
                                {% endif %}
                            </td>
                            <td>
                                {% if entry.type == 'admin' %}
                                    <span class="source-admin">Django Admin</span>
                                {% else %}
                                    <span class="source-dashboard">Dashboard</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p>{% trans "This object doesn't have a change history. It probably wasn't added via this admin site." %}</p>
        {% endif %}
    </div>
</div>

<style>
.badge {
    display: inline-block;
    padding: 0.25em 0.4em;
    font-size: 75%;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
}

.badge-info {
    color: #fff;
    background-color: #17a2b8;
}

.badge-success {
    color: #fff;
    background-color: #28a745;
}

.source-admin {
    color: #17a2b8;
    font-weight: bold;
}

.source-dashboard {
    color: #28a745;
    font-weight: bold;
}

.admin-changes {
    font-family: monospace;
    font-size: 0.9em;
}

.dashboard-changes {
    font-family: Arial, sans-serif;
    font-size: 0.9em;
}

#result_list th {
    background-color: #f8f9fa;
    border-bottom: 2px solid #dee2e6;
}

#result_list td {
    border-bottom: 1px solid #dee2e6;
    padding: 8px;
}

.row1 {
    background-color: #fff;
}

.row2 {
    background-color: #f8f9fa;
}
</style>
{% endblock %}
