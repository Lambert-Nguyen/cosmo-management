{% extends "layouts/staff_layout.html" %}
{% load static %}

{% block page_title %}Photo Comparison{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/photo-comparison.css' %}">
{% endblock %}

            <div class="task-title">{{ task.title }}</div>
            <div class="task-details">
                <strong>Property:</strong> {{ task.property_ref.name }}<br>
                <strong>Status:</strong> {{ task.get_status_display }}<br>
                <strong>Assigned to:</strong> {{ task.assigned_to.get_full_name|default:task.assigned_to.username }}
            </div>
        </div>
        <div class="filter-controls">
            <select id="status-filter" class="filter-select">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
            </select>
            <select id="type-filter" class="filter-select">
                <option value="">All Types</option>
                <option value="before">Before</option>
                <option value="after">After</option>
                <option value="during">During</option>
                <option value="reference">Reference</option>
                <option value="damage">Damage</option>
                <option value="general">General</option>
            </select>
        </div>
    </div>

    <div class="comparison-grid">
        <!-- Before Photos -->
        <div class="photo-section">
            <div class="section-header">
                <div class="section-title">
                    ðŸ“¸ Before Photos
                    <span class="photo-count" id="before-count">0</span>
                </div>
            </div>
            <div class="photo-grid" id="before-photos">
                <!-- Before photos will be loaded here -->
            </div>
        </div>

        <!-- After Photos -->
        <div class="photo-section">
            <div class="section-header">
                <div class="section-title">
                    ðŸ“¸ After Photos
                    <span class="photo-count" id="after-count">0</span>
                </div>
            </div>
            <div class="photo-grid" id="after-photos">
                <!-- After photos will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Other Photos Section -->
    <div class="photo-section">
        <div class="section-header">
            <div class="section-title">
                ðŸ“· Other Photos
                <span class="photo-count" id="other-count">0</span>
            </div>
        </div>
        <div class="photo-grid" id="other-photos">
            <!-- Other photos will be loaded here -->
        </div>
    </div>
</div>

<!-- Photo Modal -->
<div id="photo-modal" class="modal">
    <div class="modal-content">
        <button class="modal-close" data-action="close-modal">&times;</button>
        <img id="modal-image" class="modal-image" src="" alt="">
        <div class="modal-info">
            <div class="modal-title" id="modal-title"></div>
            <div class="modal-meta" id="modal-meta"></div>
            <div class="modal-description" id="modal-description"></div>
        </div>
    </div>
</div>

<script>
const TASK_ID = {{ task.id }};
</script>
<script src="{% static 'js/pages/photo-comparison.js' %}"></script>

<script>
// Event listener for modal close button
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('[data-action="close-modal"]').forEach(btn => {
        btn.addEventListener('click', closeModal);
    });
});
</script>
{% endblock %}
